diff --git a/Source/WTF/wtf/PlatformJSCOnly.cmake b/Source/WTF/wtf/PlatformJSCOnly.cmake
index 21eb0e276916..cb869e6da35f 100644
--- a/Source/WTF/wtf/PlatformJSCOnly.cmake
+++ b/Source/WTF/wtf/PlatformJSCOnly.cmake
@@ -1,3 +1,15 @@
+if (WTF_CPU_X86_64)
+    if (MSVC)
+        add_custom_command(
+            OUTPUT ${WTF_DERIVED_SOURCES_DIR}/AsmStubsMSVC64.obj
+            MAIN_DEPENDENCY ${WTF_DIR}/wtf/win/AsmStubsMSVC64.asm
+            COMMAND ml64 -nologo -c -Fo ${WTF_DERIVED_SOURCES_DIR}/AsmStubsMSVC64.obj ${WTF_DIR}/wtf/win/AsmStubsMSVC64.asm
+            VERBATIM)
+
+        list(APPEND WTF_SOURCES ${WTF_DERIVED_SOURCES_DIR}/AsmStubsMSVC64.obj)
+    endif ()
+endif ()
+
 list(APPEND WTF_SOURCES
     generic/WorkQueueGeneric.cpp
 )
@@ -122,7 +134,12 @@ else ()
     )
 endif ()
 
-if (LOWERCASE_EVENT_LOOP_TYPE STREQUAL "glib")
+if (WIN32)
+    list(APPEND WTF_SOURCES
+        win/RunLoopWin.cpp
+        win/Win32Handle.cpp
+    )
+elseif (LOWERCASE_EVENT_LOOP_TYPE STREQUAL "glib")
     list(APPEND WTF_SOURCES
         glib/GRefPtr.cpp
         glib/RunLoopGLib.cpp
@@ -161,6 +178,8 @@ else ()
     )
 endif ()
 
-list(APPEND WTF_LIBRARIES
-    Threads::Threads
-)
+if (NOT WIN32)
+    list(APPEND WTF_LIBRARIES
+        Threads::Threads
+    )
+endif ()
